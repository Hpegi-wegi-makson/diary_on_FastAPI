<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>Мои задачи</title>

<style>
body {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
    background: #f5f7fa;
    margin: 0;
    padding: 40px;
}
.container {
    max-width: 900px;
    margin: auto;
}
/* ===== Header ===== */
.header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 30px;
}
.header h1 { margin: 0; }
.header-actions { display: flex; gap: 15px; }
/* ===== Buttons ===== */
.button {
    padding: 8px 16px;
    border-radius: 8px;
    border: none;
    cursor: pointer;
    font-size: 14px;
    text-decoration: none;
}
.button--primary { background: #3b82f6; color: white; }
.button--danger { background: #ef4444; color: white; }
.button--ghost { background: transparent; border: 1px solid #ddd; }
/* ===== Stats ===== */
.stats { display: flex; gap: 20px; margin-bottom: 30px; }
.stat-box { flex: 1; background: white; border-radius: 12px; padding: 20px; box-shadow: 0 2px 6px rgba(0,0,0,0.05); }
.stat-title { font-size: 13px; color: #777; }
.stat-value { font-size: 26px; font-weight: bold; }
/* ===== Form ===== */
.form-card {
    background: white;
    padding: 25px;
    border-radius: 12px;
    margin-bottom: 30px;
    box-shadow: 0 2px 6px rgba(0,0,0,0.05);
}
.form { display: flex; flex-direction: column; gap: 12px; }
.form input, .form textarea { padding: 10px; border-radius: 8px; border: 1px solid #ddd; font-size: 14px; }
/* ===== Task List ===== */
.task-list { display: flex; flex-direction: column; gap: 15px; }
.task-item {
    background: white;
    border-radius: 12px;
    padding: 18px;
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    box-shadow: 0 2px 6px rgba(0,0,0,0.05);
}
.task-title { font-size: 18px; font-weight: 600; }
.task-title.done { text-decoration: line-through; color: #999; }
.task-description { margin-top: 6px; color: #555; }
.task-meta { font-size: 12px; margin-top: 10px; color: #888; }
.task-actions { display: flex; flex-direction: column; gap: 8px; }
/* ===== Empty ===== */
.empty-state {
    text-align: center;
    padding: 40px;
    background: white;
    border-radius: 12px;
    color: #777;
}
</style>
</head>

<body>
<div class="container">

<!-- ===== HEADER ===== -->
<div class="header">
    <h1>Мои задачи</h1>
    <div class="header-actions">
        <span>{{ current_user.email}}</span>
        <a href="/logout" class="button button--ghost">Выйти</a>
    </div>
</div>

<!-- ===== STATS ===== -->
<div class="stats">
    <div class="stat-box">
        <div class="stat-title">Всего задач</div>
        <div class="stat-value">{{ total }}</div>
    </div>
    <div class="stat-box">
        <div class="stat-title">Выполнено</div>
        <div class="stat-value">{{ done_count }}</div>
    </div>
    <div class="stat-box">
        <div class="stat-title">Активные</div>
        <div class="stat-value">{{ total - done_count }}</div>
    </div>
</div>

<!-- ===== CREATE TASK ===== -->
<div class="form-card">
<form class="form" method="POST" action="/path_task/create">
    <input type="text" name="title" placeholder="Название задачи" required>
    <input type="date" name="due_date" placeholder="Срок выполнения">
    <textarea name="description" placeholder="Описание задачи"></textarea>
    <button type="submit" class="button button--primary">Создать задачу</button>
</form>
</div>

<!-- ===== TASK LIST ===== -->
<div class="task-list">

{% if tasks %}
    {% for task in tasks %}
    <div class="task-item">
        <div>
            <div class="task-title {% if task.is_done %}done{% endif %}">{{ task.title }}</div>
            {% if task.description %}
            <div class="task-description">{{ task.description }}</div>
            {% endif %}
            <div class="task-meta">
                Статус: {% if task.is_done %}Выполнено{% else %}В работе{% endif %}
                {% if task.due_date %} | Срок: {{ task.due_date.strftime("%d.%m.%Y") }}{% endif %}
            </div>
        </div>

        <div class="task-actions">
            <!-- Редактировать -->
            <a href="/path_task/edit/{{ task.id }}" class="button button--ghost">Изменить</a>

            <!-- Удалить -->
            <form method="POST" action="/path_task/delete/{{ task.id }}">
                <button type="submit" class="button button--danger">Удалить</button>
            </form>
        </div>
    </div>
    {% endfor %}
{% else %}
    <div class="empty-state">У вас пока нет задач</div>
{% endif %}

</div>
</div>
</body>
</html>