# FastAPI JWT‚Äë—Å–µ—Ä–≤–∏—Å –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏

–ë—ç–∫–µ–Ω–¥‚Äë—Å–µ—Ä–≤–∏—Å –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –Ω–∞ –±–∞–∑–µ **FastAPI** —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º **JWT** –∏ —Ä–æ–ª–µ–≤–æ–π –º–æ–¥–µ–ª–∏ –¥–æ—Å—Ç—É–ø–∞ (**RBAC**).
–ü—Ä–æ–µ–∫—Ç –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç –ø—Ä–æ—Å—Ç—É—é, –Ω–æ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É API –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤.

---

## –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

–°–µ—Ä–≤–∏—Å –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç:

* —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—é –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π;
* –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é –ø–æ email –∏ –ø–∞—Ä–æ–ª—é;
* JWT‚Äë–∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é;
* –¥–æ—Å—Ç—É–ø –∫ –∑–∞—â–∏—â—ë–Ω–Ω—ã–º —ç–Ω–¥–ø–æ–∏–Ω—Ç–∞–º;
* –ø—Ä–æ–≤–µ—Ä–∫—É —Ä–æ–ª–µ–π (RBAC).

### –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

* –ø–∞—Ä–æ–ª–∏ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ —Ö—ç—à–∏—Ä–æ–≤–∞–Ω–Ω–æ–º –≤–∏–¥–µ (`bcrypt`);
* JWT‚Äë—Ç–æ–∫–µ–Ω—ã –ø–æ–¥–ø–∏—Å—ã–≤–∞—é—Ç—Å—è —Å–µ–∫—Ä–µ—Ç–Ω—ã–º –∫–ª—é—á–æ–º —Å –∞–ª–≥–æ—Ä–∏—Ç–º–æ–º **HS256**.

---

## –°—Ç–µ–∫ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π

* üêç **Python** 3.10+
* ‚ö° **FastAPI**
* üóÑ **SQLAlchemy**
* üì¶ **SQLite**
* üîê **Passlib** (`bcrypt`)
* ü™™ **python‚Äëjose** (JWT)
* üìÑ **Pydantic**

---

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```text
.
‚îú‚îÄ‚îÄ main.py          # FastAPI –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏ HTTP‚Äë—ç–Ω–¥–ø–æ–∏–Ω—Ç—ã
‚îú‚îÄ‚îÄ database.py      # –ë–î, –º–æ–¥–µ–ª–∏ SQLAlchemy, CRUD, —Ä–∞–±–æ—Ç–∞ —Å –ø–∞—Ä–æ–ª—è–º–∏
‚îú‚îÄ‚îÄ jwt_manager.py   # JWT, –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è, –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–æ–ª–µ–π
‚îú‚îÄ‚îÄ schemas.py       # Pydantic‚Äë—Å—Ö–µ–º—ã –∑–∞–ø—Ä–æ—Å–æ–≤ –∏ –æ—Ç–≤–µ—Ç–æ–≤
‚îú‚îÄ‚îÄ config.py        # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è, —Å–µ–∫—Ä–µ—Ç—ã, —Ä–æ–ª–∏
‚îî‚îÄ‚îÄ database.db      # SQLite –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
```

---

## –ó–∞–ø—É—Å–∫ –ø—Ä–æ–µ–∫—Ç–∞

### 1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è

```bash
git clone https://github.com/your-username/your-repo.git
cd your-repo
```

### 2. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
pip install -r requirements.txt
```

### 3. –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞

```bash
uvicorn main:app --reload
```

---

## –î–æ—Å—Ç—É–ø –∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—é

* üìç API: [http://127.0.0.1:8000](http://127.0.0.1:8000)
* üìò Swagger UI: [http://127.0.0.1:8000/docs](http://127.0.0.1:8000/docs)
* üè† –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞: [http://127.0.0.1:8000](http://127.0.0.1:8000)

---

## API Endpoints

### –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

**POST** `/registration`

```json
{
  "email": "user@example.com",
  "password": "password123"
}
```

---

### –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è

**POST** `/login`

```json
{
  "email": "user@example.com",
  "password": "password123"
}
```

**–û—Ç–≤–µ—Ç:**

```json
{
  "access_token": "jwt_token",
  "refresh_token": "refresh_token",
  "token_type": "bearer"
}
```

---

### –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞

**POST** `/token/refresh`

```json
{
  "refresh_token": "refresh_token"
}
```

---

### –í—ã—Ö–æ–¥

**POST** `/logout`

```json
{
  "refresh_token": "refresh_token"
}
```

---

### –¢–µ–∫—É—â–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å

**GET** `/me`

**–ó–∞–≥–æ–ª–æ–≤–æ–∫ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏:**

```
Authorization: Bearer <jwt_token>
```

---

### –ê–¥–º–∏–Ω‚Äë–¥–æ—Å—Ç—É–ø

**GET** `/admin`

* —Ç—Ä–µ–±—É–µ—Ç—Å—è —Ä–æ–ª—å: `admin`

---

## –†–æ–ª–∏ –¥–æ—Å—Ç—É–ø–∞

| –†–æ–ª—å      | –û–ø–∏—Å–∞–Ω–∏–µ             |
| --------- | -------------------- |
| user      | –û–±—ã—á–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å |
| moderator | –ú–æ–¥–µ—Ä–∞—Ç–æ—Ä            |
| admin     | –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä        |

–†–æ–ª–∏ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—é—Ç—Å—è –≤ `config.py`.

---

## JWT

* —Ç–∏–ø —Ç–æ–∫–µ–Ω–∞: **Access Token**
* –∞–ª–≥–æ—Ä–∏—Ç–º –ø–æ–¥–ø–∏—Å–∏: **HS256**
* –≤—Ä–µ–º—è –∂–∏–∑–Ω–∏: `ACCESS_TOKEN_EXPIRE_MINUTES`

### Payload

* `id`
* `email`
* `exp`

---

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

* –ø–∞—Ä–æ–ª–∏ —Ö—ç—à–∏—Ä—É—é—Ç—Å—è —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º **bcrypt**;
* JWT –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –Ω–∞ –≤–∞–ª–∏–¥–Ω–æ—Å—Ç—å –∏ —Å—Ä–æ–∫ –¥–µ–π—Å—Ç–≤–∏—è;
* –∑–∞—â–∏—â—ë–Ω–Ω—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã —á–µ—Ä–µ–∑ **FastAPI dependencies**.

---

–ü—Ä–æ–µ–∫—Ç –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω –¥–ª—è —É—á–µ–±–Ω—ã—Ö –∏ –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ü–µ–ª–µ–π –∏ –º–æ–∂–µ—Ç –±—ã—Ç—å —Ä–∞—Å—à–∏—Ä–µ–Ω (refresh‚Äëtokens, PostgreSQL, Alembic, OAuth2, permissions scope –∏ —Ç.–¥.).
